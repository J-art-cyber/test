<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ¡å¯¸å…¥åŠ›ãƒ†ã‚¹ãƒˆ</title>
  <style>
    input { width: 80px; padding: 5px; text-align: center; }
    td:focus-within { background: #eef; }
  </style>
</head>
<body>
  <h2>æ¡å¯¸å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆéŸ³å£° "æ¬¡" ã§ç§»å‹•ï¼‰</h2>
  <button onclick="startVoice()">ğŸ™ï¸ éŸ³å£°é–‹å§‹</button>
  <table border="1">
    <thead>
      <tr><th>ã‚µã‚¤ã‚º</th><th>ã‚¦ã‚¨ã‚¹ãƒˆ</th><th>è‚¡ä¸Š</th><th>ãƒ¯ã‚¿ãƒª</th><th>å‚™è€ƒ</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><input value="M" readonly></td>
        <td><input></td>
        <td><input></td>
        <td><input></td>
        <td><input></td>
      </tr>
    </tbody>
  </table>

  <script>
    // Enterã‚­ãƒ¼ã§å³ç§»å‹•
    document.querySelectorAll("input").forEach((input, i, all) => {
      input.addEventListener("keydown", e => {
        if (e.key === "Enter") {
          e.preventDefault();
          if (all[i + 1]) all[i + 1].focus();
        }
      });
    });

    // éŸ³å£°èªè­˜ã‚¹ã‚¿ãƒ¼ãƒˆ
    function startVoice() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const recog = new SpeechRecognition();
      recog.lang = "ja-JP";
      recog.continuous = true;
      recog.interimResults = false;
      recog.onresult = e => {
        const transcript = e.results[e.resultIndex][0].transcript.trim();
        console.log("éŸ³å£°èªè­˜:", transcript);
        if (transcript.includes("æ¬¡")) {
          const active = document.activeElement;
          const all = Array.from(document.querySelectorAll("input"));
          const i = all.indexOf(active);
          if (i >= 0 && all[i + 1]) all[i + 1].focus();
        } else {
          document.activeElement.value += transcript;
        }
      };
      recog.start();
      alert("ğŸ™ï¸ éŸ³å£°å…¥åŠ›é–‹å§‹ã€‚ã€Œæ¬¡ã€ã¨è¨€ã†ã¨å³ã«ç§»å‹•ã—ã¾ã™ã€‚");
    }
  </script>
</body>
</html>
